Scheme
(R x) >>>= f = (f x)
(P l r) >>>= f = (P (l >>>= f)(r >>>= f))
(S l r) >>>= f = (S (l >>>= f)(r >>>= f))